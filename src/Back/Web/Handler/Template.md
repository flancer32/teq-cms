# Fl32_Cms_Back_Web_Handler_Template — обработка HTTP-запросов

## Назначение

Обработчик отвечает за поиск и рендеринг шаблонов CMS. Он включён в цепочку веб-обработчиков и расположен перед
`Fl32_Web_Back_Handler_Static` (обработка статического контента). Критерий активации — наличие шаблона, соответствующего
веб-запросу. Если шаблон не найден, управление передаётся дальше (`return false`).

## Адрес шаблона

Разбор URL и cookies выполняется не CMS, а вызывающим кодом через метод `getRenderData` интерфейса
`Fl32_Cms_Back_Api_Adapter`. Метод возвращает структуру `Fl32_Cms_Back_Api_Adapter.RenderData`, содержащую:

- целевой шаблон (`Fl32_Tmpl_Back_Dto_Target.Dto`);
- данные для рендеринга.

## Загрузка шаблона

Шаблоны могут быть локализованными и находиться как в приложении, так и в npm-пакетах. Приложение может переопределять
шаблоны пакетов. За поиск с учётом локали и переопределений отвечает `Fl32_Tmpl_Back_Service_Load`. Если подходящий
шаблон не найден ни для одной локали — обработчик завершает выполнение и передаёт управление следующему компоненту
веб-цепочки.

## Локаль в URL

Все веб-запросы должны содержать префикс локали (`/en/`, `/es-ar/`, ...). У приложения есть fallback-локаль (например,
`en`) и список разрешённых локалей (`en`, `es`, `ru`, ...). Если шаблон найден, но префикс отсутствует — выполняется
редирект (HTTP 302) на URL с префиксом. Локаль выбирается из пользовательской сессии или настроек приложения. Это
поведение соответствует требованиям поисковых систем.
